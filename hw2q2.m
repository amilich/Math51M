% Andrew Milich 
% 10/9/15
% Math 51M: Homework 2

%%%%%%%%%%%%%%
% Question 2 %
%%%%%%%%%%%%%%

% Strassen multiplication. % 

function M = hw2q2(A, B)
    [r1,c1] = size(A);
    [r2,c2] = size(B);
    
    if(r1 == 2 && c1 == 2 && r2 == 2 && c2 == 2)
        M1 = (A(1,1)+A(2,2))*(B(1,1)+B(2,2));
        M2 = (A(2,1)+A(2,2))*B(1,1); 
        M3 = A(1,1)*(B(1,2)-B(2,2));
        M4 = A(2,2)*(B(2,1)-B(1,1)); 
        M5 = (A(1,1)+A(1,2))*B(2,2);
        M6 = (A(2,1)-A(1,1))*(B(1,1)+B(1,2));
        M7 = (A(1,2)-A(2,2))*(B(2,1)+B(2,2));
        M = [M1 + M4 - M5 + M7, M3 + M5; M2 + M4, M1 - M2 + M3 + M6]; 
        return 
    end
    
    a1 = mat2cell(A, [r1/2 r1/2], [c1/2 c1/2]);
    b1 = mat2cell(B, [r1/2 r1/2], [c1/2 c1/2]);
    
    M1 = hw2q2((a1{1,1}+a1{2,2}),(b1{1,1}+b1{2,2}));
    M2 = hw2q2((a1{2,1}+a1{2,2}),b1{1,1}); 
    M3 = hw2q2(a1{1,1},(b1{1,2}-b1{2,2}));
	M4 = hw2q2(a1{2,2},(b1{2,1}-b1{1,1})); 
	M5 = hw2q2((a1{1,1}+a1{1,2}),b1{2,2});
    M6 = hw2q2((a1{2,1}-a1{1,1}),(b1{1,1}+b1{1,2}));
    M7 = hw2q2((a1{1,2}-a1{2,2}),(b1{2,1}+b1{2,2}));
    M = [M1 + M4 - M5 + M7, M3 + M5; M2 + M4, M1 - M2 + M3 + M6];
end 